generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model user {
  id        Int              @id @default(autoincrement())
  firstName String           @db.VarChar
  lastName  String           @db.VarChar
  email     String           @db.VarChar
  password  String           @db.VarChar
  authored  book[]           @relation("UserBooks") // Relation with books authored by the user
  read      readingHistory[]
}

model chapter {
  id             Int              @id @default(autoincrement())
  title          String           @db.VarChar
  content        String           @db.VarChar
  book           book             @relation(fields: [bookId], references: [id])
  bookId         Int
  chapterNo      Int
  readingHistory readingHistory[]
}

model readingHistory {
  id        Int      @id @default(autoincrement())
  user      user     @relation(fields: [userId], references: [id])
  userId    Int
  book      book     @relation(fields: [bookId], references: [id])
  bookId    Int
  chapter   chapter  @relation(fields: [chapterId], references: [id])
  chapterId Int
  lastRead  DateTime @db.Timestamp(6)
  lastPage  Int
}

model book {
  id             Int              @id @default(autoincrement())
  title          String           @db.VarChar
  author         user             @relation("UserBooks", fields: [authorId], references: [id])
  genre          String
  publishedDate  DateTime         @db.Timestamp(6)
  lastUpdated    DateTime         @db.Timestamp(6)
  authorId       Int
  data           String           @db.VarChar
  coverImage     String?          @db.VarChar  // Add this field
  chapters       chapter[]
  readingHistory readingHistory[]
}
